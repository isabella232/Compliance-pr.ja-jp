---
title: Microsoft 365 Exchange Onlineデータの削除
description: メールボックスおよびメールボックス内のアイテムに対するデータのソフト削除とハード 削除の処理方法については、Exchange Online。
ms.author: robmazz
author: robmazz
manager: laurawi
ms.reviewer: sosstah
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
ms.localizationpriority: medium
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- MS-Compliance
f1.keywords:
- NOCSH
ms.custom: seo-marvel-apr2020
titleSuffix: Microsoft Service Assurance
hideEdit: true
ms.openlocfilehash: 9dd365e075226d8fdbfd1a9f9e371df2668f814d
ms.sourcegitcommit: 997dd3f66f65686c2e38b7e30e67add426dce5f3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/12/2021
ms.locfileid: "59160071"
---
# <a name="exchange-online-data-deletion-in-microsoft-365"></a>Exchange Onlineのデータ削除のMicrosoft 365

このExchange Online、削除には、ソフト削除とハード削除の 2 種類があります。 これは、メールボックスとメールボックス内のアイテムの両方に適用されます。

## <a name="soft-deleted-and-hard-deleted-mailboxes"></a>削除済みメールボックスとハード削除されたメールボックス

ソフト削除されたユーザー メールボックスは、Microsoft 365 管理センター または Remove-Mailbox コマンドレットを使用して削除されたメールボックスであり、Azure Active Directory ごみ箱に 30 日未満残っています。 メールボックスは、次の方法でソフト削除される場合があります。

- ユーザー アカウントに関連付Azure Active Directoryユーザー アカウントが削除されます (ユーザー オブジェクトがスコープ外またはごみ箱コンテナー内にある)。
- ユーザー アカウントに関連付Azure Active Directoryユーザー アカウントが削除されましたが、Exchange Onlineが訴訟ホールドまたは電子情報開示ホールドの下に置かされています。
- ユーザー アカウントに関連付けられているユーザー Azure Active Directoryは、過去 30 日以内に削除されました。これは、メールボックスが完全に削除Exchange Online回復不能にされる前に、メールボックスをソフト削除状態に保つ最大保持長です。

ハード削除されたユーザー メールボックスは、次のいずれかの方法で削除されたメールボックスです。

- ユーザー メールボックスが 30 日間以上ソフト削除され、関連付Azure Active Directoryがハード削除されました。 メール、連絡先、ファイルなどのメールボックスのコンテンツはすべて完全に削除されます。
- ユーザー メールボックスに関連付けられているユーザー アカウントが、ユーザー メールボックスからハードAzure Active Directory。 ユーザー メールボックスは現在、Exchange Onlineでソフト削除され、30 日間、ソフト削除された状態を保持します。 30 日間で、新しい Azure Active Directory ユーザーが元の受信者アカウントと同じ **ExchangeGuid** または **ArchiveGuid** で同期され、その新しいアカウントが Exchange Online のライセンスを取得している場合、元のユーザー メールボックスがハード削除されます。 メール、連絡先、ファイルなどのメールボックスのコンテンツはすべて完全に削除されます。
- 削除済みメールボックスは **Remove-Mailbox -PermanentlyDelete を使用して削除されます**。

上記の削除シナリオでは、ユーザー メールボックスが訴訟ホールドや電子情報開示ホールドなど、保持状態に含めなかったと仮定します。 メールボックスに保持の種類がある場合は、メールボックスを削除できません。 すべてのメール ユーザー受信者の種類では、[](https://support.office.com/article/manage-legal-investigations-in-office-365-2e5fbe9f-ee4d-4178-8ff8-4356bc1b168e?ui=en-US&rs=en-US&ad=US)保持設定は無視され、ハード削除やソフト削除には影響しません。

## <a name="soft-deleted-and-hard-deleted-items"></a>削除済みアイテムとハード削除済みアイテム

ユーザーがメールボックス アイテム (電子メール メッセージ、連絡先、予定表の予定、タスクなど) を削除すると、アイテムは [回復可能なアイテム] フォルダーに移動され、"Deletes" という名前のサブフォルダーに移動されます。 これは、ソフト削除と呼ばれます。 削除したアイテムが [削除] フォルダーに保持される期間は、メールボックスに設定された 削除済アイテムの保持期間によって決まります。 既定Exchange Onlineメールボックスは削除済みアイテムを 14 日間保持しますが、Exchange Online 管理者は、この設定を変更して最大 30 日間の期間を増やします。 (Exchange Online メールボックスの削除済みアイテム保持期間を長くする詳細な手順については、「Exchange Online メールボックスの完全に削除されたアイテムを保持する期間を変更する」[を参照](/exchange/recipients-in-exchange-online/manage-user-mailboxes/change-deleted-item-retention)してください。ユーザーは、削除済みアイテムの保持時間が経過する前に、削除済みアイテムを回復または削除できます。 これを行うには、Microsoft の [削除済みアイテムの回復] 機能を使用OutlookまたはOutlook on the web。

ユーザーが Outlook または Outlook on the web の [削除済みアイテムの回復] 機能を使用して削除済みアイテムを削除した場合、これはハード削除と呼ばれる。 このExchange Online、新しいメールボックスの作成時に単一アイテムの回復が既定で有効になっているので、削除済[](/Exchange/recipients/user-mailboxes/recover-deleted-messages)みアイテムの保持期間が経過する前に、管理者は引き続きハード削除されたアイテムを回復できます。 また、単一アイテムの回復が有効になっていれば、ユーザーまたはプロセスによってメッセージが変更されたときに、元のアイテムのコピーの保存も行われます。

## <a name="page-zeroing"></a>ページのゼロ化

*ゼロ化* は、削除されたデータに対してゼロまたはバイナリ パターンを書き込み、削除されたデータの回復が困難になるセキュリティ メカニズムです。 このExchange Onlineメールボックス データベースは、ページをストレージの単位として使用し、ページゼロと呼ばれる上書きプロセス *を実装します*。 ページのゼロ設定は既定で有効になっているので、お客様または Microsoft が無効にすることはできません。 ページゼロ操作はトランザクション ログ ファイルに記録され、特定のデータベースのすべてのコピーが同様の方法でページゼロになります。 アクティブなデータベース コピーでページをゼロにすると、データベースのパッシブ コピーでページが 0 になります。

ページゼロは、ハード削除されたレコードに対してバイナリ パターンを書き込みます。 ページゼロパターンは、拡張 Storage エンジン (ESE) 操作 (Exchange Online 内のサーバーで使用される内部データベース エンジンの名前) に固有のパターンであり、実行時操作とバックグラウンド データベースメンテナンス操作では異なります。 (バックグラウンド データベースのメンテナンスは、各データベースを継続的にチェックサムおよびスキャンするプロセスです。 主な機能は、データベース ページのチェックサムですが、領域のクリーンアップや、ストアクラッシュのためにゼロにされていないレコードとページのゼロアウトも処理します)。

次の表に、特定の実行時操作に対応したパターンを一覧表示します。

| ESE 実行時操作   | パターン |
|--------------------------|--------------|
| 置換                  | R            |
| レコード/長い値の削除 | D            |
| 解放されたページ領域         | H            |

次の表は、ESE バックグラウンド データベース保守で実行される特定の操作に対応したパターンの一覧です。

| ESE バックグラウンド データベース保守操作 | パターン |
|-----------------------------------------------|--------------|
| レコードの削除                                 | D            |
| 長い値の削除                             | L            |
| 部分的に使用されたページの解放されたページ領域       | Z            |
| 未使用ページの解放されたページ領域               | U            |

### <a name="page-zeroing-process"></a>ページのゼロ化プロセス

ページのゼロ化のプロセスは、削除シナリオによって異なります。 次の表に、データベースの削除のシナリオ、およびページ解放機能が実行される時点について説明します。

| データベースの削除のシナリオ | データベース データを解放するための ESE プロセスと期間 |
|:--------------------------|:------------------------------------------------|
| アイテムの有効期限は、削除されたアイテムの保持期間に基づいて行います。 | 非同期のスレッドは、バイナリ パターンを削除されたデータに上書きします。 この操作はレコード削除の数ミリ秒以内に実行されます。 非同期ゼロ作業がまだ未解決の間にストア プロセスがクラッシュした場合 (またはバージョン ストアの増加によりバージョン ストアのクリーンアップが取り消された場合)、バックグラウンド データベースのメンテナンスがデータベースのそのセクションを処理すると、ゼロが完了します。 |
| シナリオの表示: フォルダー ビュー Outlook/Outlook on the webアイテムの有効期限 (会話ビューなど) | バックグラウンド データベース保守でデータベースのこのセクションが処理されたときに、データ解放が実行されます。 |
| Move Mailbox/Delete Mailbox Scenario: Source Mailbox deleted (削除済みメールボックスの有効期限) | バックグラウンド データベース保守でデータベースのこのセクションが処理されたときに、データ解放が実行されます。 |

### <a name="mailbox-data-types-without-page-zeroing"></a>ページをゼロにしないメールボックス データ型

次のメールボックス データ型には、ページのゼロ設定の準備はありません。

- **メールボックス データベース トランザクション ログ** - トランザクション ログが通常の操作の一部として削除された場合、削除されたログ ファイルを格納したファイル システム内のブロックをゼロにするプロセスはありません。 ファイル システムは、新しく作成されたログの空き領域をすぐに再使用する可能性がありますが、これが発生する保証はありません。
- **コンテンツ インデックス カタログ ファイル**- Exchange Onlineインデックス作成機能に Search Foundation (FAST とも呼ばれる) を使用します。 検索インデックス カタログは、メールボックス データベース ファイルと同じボリュームに格納されている数十個のファイルで構成されます。 メッセージがメールボックス データベースから物理的に削除されても、検索カタログ内の関連付けられているコンテンツはすぐには削除されません。 コンテンツの削除は、Search Foundation が多数の小さなカタログ ファイルを 1 つの大きなファイルにシャドウ (またはマスター マージ) する場合に発生します。 マスター結合が完了すると、小さいカタログ ファイルが削除されます。 削除されたカタログ ファイルを格納したブロックをゼロにするプロセスはありません。

## <a name="continuous-replication"></a>継続的レプリケーション

継続的レプリケーション (ログ配布と再生とも呼ばれる) は、Exchange Online のテクノロジで、高可用性、サイトの復元、および障害復旧を提供するために、すべてのメールボックス データベースのコピーを作成および維持します。 継続的レプリケーションは、Exchange Serverクラッシュ復旧サポートを使用して、メールボックス データベースの 1 つ以上のコピーの非同期更新を実行するテクノロジを提供します。 各メールボックス サーバーは、アクティブ なデータベース (ユーザーの電子メール アクティビティなど) で行われたデータベースの更新を、1 MB のトランザクション ログ ファイルの順次セットのログ レコードとして記録します。 この一連のファイルは、ログ ストリームと呼ばれます。 継続的レプリケーションでは、ログ ストリームを使用して、データベースの 1 つ以上のコピーを非同期的に更新します。 これは、アクティブ なデータベースのパッシブ コピーを含む場所にログを送信し、パッシブ データベース コピーに再生することで実現されます。 アクティブ なデータベースのすべてのログがデータベースのパッシブ コピーに対して再生される場合、2 つのデータベースは同等であり、アクティブ なデータベースに対して行われた物理的な変更は、そのデータベースのすべてのパッシブ コピーにレプリケートされます。

メールボックス データベースからの削除は、メールボックス アイテムかメールボックス全体か、および回復可能な削除かハード削除かに関わりなく、アクティブ なデータベースに対する物理的な変更を表します。 ページのゼロ化には、アクティブ なデータベースに物理的な変更を加える必要があります。 これらの変更は、継続的レプリケーションと呼ばれるプロセスを通じてログ ファイルに書き込まれます。また、それらのログ ファイルがデータベースのパッシブ コピーに対して再生される場合は、それらのパッシブ データベースに対して同じ物理的な変更が行います。
